---
title: 'CORS verstehen'
description: 'In diesem Thema erfahren Sie mehr über CORS und in das Web integrierte Einschränkungen bezüglich der ursprungsübergreifenden Referenzierung von Assets wie Videos, Bildern und Skripts.'
parent: Developers
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Overview">Überblick</h2>
    <p>Cross-Origin Resource Sharing (CORS) ist ein Mechanismus, mit dem eine Webseite Anforderungen an eine andere Domäne als die stellen kann, von der aus die Seite bereitgestellt wurde. Normalerweise würden domänenübergreifende Anfragen von Webbrowsern ansonsten verboten. CORS definiert eine Art und Weise, wie Domänen interagieren können, um zu bestimmen, ob Ursprungsübergreifende Anforderungen zugelassen werden sollen oder nicht.</p>
    <aside class="bcls-aside bcls-aside--information">Beachten Sie, dass CORS <strong>nicht</strong> aktiviert von oder verwandt mit crossdomain.xml, einem Mechanismus zum Aktivieren von domänenübergreifenden Anforderungen für Flash-Anwendungen.</aside>
  </section>
  <section class="bcls-section">
    <h2 id="corsandbc">CORS und Brightcove</h2>
    <p>Es gibt drei Fälle, in denen CORS mit Brightcove-Diensten / -Produkten verwendet werden muss:</p>
    <ol>
      <li><strong>Bildunterschriften für Videos</strong>:: Die Datei, die Untertitel für ein Video enthält, kann in einer Nicht-Brightcove-Domäne gespeichert werden. Da das Video selbst von einer Brightcove-Domäne bereitgestellt wird, führt dies zu domänenübergreifenden Problemen.</li>
      <li><strong>Brightcove Player und HLS</strong>:: Die <span class="video-cloud-only" translate="No">Brightcove Players </span>Das HLS-Plugin verwendet AJAX-Anforderungen, um das Manifest und einzelne Segmente des HLS-Videos abzurufen. Da diese HLS-Ressourcen in jeder über das Internet zugänglichen Domäne gespeichert werden können, werden diese Ressourcen wahrscheinlich von einem anderen Server (normalerweise einer CDN-Domäne) als von der Brightcove-Domäne bereitgestellt, die den Player bedient hat. Dies führt erneut zu domänenübergreifenden Problemen.</li>
      <li><strong>Video Still- und Miniaturbilder</strong>: Zum <a href="https://studio.support.brightcove.com/media/capturing-poster-and-thumbnail-images.html">Aufnehmen von Videostill- und Miniaturbildern in Studio</a> muss die Videowiedergabe mit CORS-Headern bedient werden (die bei den meisten Brightcoves aktiviert sein sollten Haus-CDNs standardmäßig); Wenn Sie ein benutzerdefiniertes CDN haben oder eines, das wir noch nicht aktualisiert haben, funktioniert die Bildaufnahme nicht</li>
    </ol>
  </section>
  <section class="bcls-section">
    <h2 id="solution">Lösungen</h2>
    <p>Die Lösung, die Brightcove derzeit verwendet, umfasst die Konfiguration eines <code translate="No">Access-Control-Allow-Origin</code> Header in der Konfigurationsdatei des CDN-Ursprungsservers. Es ist wichtig zu beachten, dass die folgenden Header-Informationen als Beispiel und nicht als Drop-In-Code-Snippet angeboten werden, da verschiedene CDN-Partner unterschiedliche Serverlösungen verwenden, um ihre Inhalte bereitzustellen.</p>
    <p>Brightcove hatte Erfolg mit der folgenden Header-Direktive für die Eigenschaften des internen CDN-Servers:</p>
    <pre class="line-numbers">
<code class="language-apache" translate="No">&lt;FilesMatch ".(vtt|xml)$"&gt;
              Header set Access-Control-Allow-Headers: X-Requested-With
              Header add Access-Control-Allow-Origin: http://admin.brightcove.com
          &lt;/FilesMatch&gt;</code></pre>
    <p>Im Folgenden werden die Richtlinien kurz erläutert:</p>
    <ul>
      <li><code translate="No">&lt;FilesMatch ".(vtt|xml)$"&gt;</code>:: Diese Bedingung setzt die <code translate="No">Access-Control-Allow-Origin</code> Header nur für vtt- oder xml-Dateien. Tests haben bestätigt, dass dieser Header nicht mit Bildern oder anderen von http bereitgestellten Inhalten gesendet wird.</li>
      <li><code translate="No">Header set Access-Control-Allow-Headers: X-Requested-With</code>:: Dieser Header wird für die benötigt <code translate="No">Access-Control-Allow-Origin</code> Header zu arbeiten, da die Anfrage, die der Spieler macht, eine XmlHttpRequest ist.</li>
      <li><code translate="No">Header add Access-Control-Allow-Origin: http://admin.brightcove.com</code>:: Dies ist der Zugriffssteuerungsheader selbst, um Inhalte aus der angegebenen Domäne zuzulassen.</li>
    </ul>
    <h3>Aktivieren von CORS unter Apache</h3>
    <p>Sie können in der Konfiguration von Apache-Servern einen Header festlegen, um CORS zu aktivieren. Stellen Sie Folgendes in das entsprechende Feld <code translate="No">.conf</code> Datei:</p>
    <pre class="line-numbers">
<code class="language-bash" translate="No">Header set Access-Control-Allow-Origin "*"</code></pre>
    <p>Im obigen Beispiel fungieren die Sternchen als Platzhalter und ermöglichen den Zugriff auf alle Domänen. Der Platzhalter kann auch durch ersetzt werden <strong>einer</strong> spezifische Domain. Dies funktioniert bei Brightcove-Playern im Allgemeinen nicht, da sich Assets in vielen Fällen auf mehreren Domänen befinden. Sie können andere Lösungen implementieren, um den Zugriff auf eine bestimmte Whitelist akzeptabler Domänen zu beschränken.</p>
    <h3>BYO CDN</h3>
    <p>Wenn Sie ein Kunde mit einem BYO-CDN sind und domänenübergreifende Probleme haben, sollten Sie sich an Ihr CDN wenden, um Hilfe bei der Konfiguration von CORS für Ihr Konto zu erhalten. Hier sind die Einstellungen, die wir empfehlen:</p>
    <ul>
      <li>Access-Control-Allow-Header: X-Angefordert-Mit</li>
      <li>Zugriffskontrolle-Zulassen-Ursprung: *</li>
      <li>Dateiformate: m3u8 m3u ts xml dfxp vtt mpd m4f mp4 jpg png</li>
    </ul>
    <h3>Token-Autorisierungsanforderungen</h3>
    <p>In dem Fall, in dem eine Token-Autorisierung erforderlich ist, müssen Änderungen an der obigen Lösung vorgenommen werden. Im Falle einer Token-Autorisierung verbietet das CORS-Sicherheitsmodell ausdrücklich die Verwendung von <code translate="No">*</code> Zeichen als Wert für die <code translate="No">Access-Control-Allow-Origin</code> Antwortheader. Darüber hinaus ist der <code translate="No">Access-Control-Allow-Credentials</code> Antwortheader erforderlich und muss auf „true“ festgelegt sein.</p>
    <p>Eine aktualisierte Header-Direktive für die Token-Autorisierung lautet:</p>
    <pre class="line-numbers">
<code class="language-apache" translate="No">&lt;FilesMatch ".(m3u8 | m3u | ts)$"&gt;
        # with AJAX withCredentials=true (cookies sent, SSL allowed...)
        SetEnvIfNoCase ORIGIN (.*) ORIGIN=$1
        Header set Access-Control-Allow-Origin "%{ORIGIN}e"
        Header set Access-Control-Allow-Credentials "true"
        RewriteEngine On
        RewriteCond %{REQUEST_METHOD} OPTIONS
        RewriteRule ^(.*)$ $1 [R=200,L,E=HTTP_ORIGIN:%{HTTP:ORIGIN}]
  &lt;/FilesMatch&gt;</code></pre>
    <p>Die folgenden Punkte beschreiben die Unterschiede zur früheren Lösung:</p>
    <ul>
      <li>Die Direktive fragt die eingehende Anforderung auf das Vorhandensein eines Origin-Headers ab, und wenn dieser Header vorhanden ist (normalerweise ist es), legt seinen Wert auf eine Variable mit dem Namen <code translate="No">ORIGIN</code>: <code translate="No">SetEnvIfNoCase ORIGIN (.*) ORIGIN=$1</code></li>
      <li>Die <code translate="No">Access-Control-Allow-Origin</code> Der Wert des Antwort-Headers wird auf den Wert des gesetzt <code translate="No">ORIGIN</code> Variable gerade erstellt: <code translate="No">Header set Access-Control-Allow-Origin "%{ORIGIN}e"</code> <aside class="bcls-aside bcls-aside--information">Die <code translate="No">e</code> ist erforderlich, um anzuzeigen, dass es sich um eine Umgebungsvariable handelt.</aside>
      </li>
      <li>Der <code translate="No">Access-Control-Allow-Credentials</code> Header muss auf Folgendes eingestellt sein <code translate="No">true</code>: <code translate="No">Header set Access-Control-Allow-Credentials "true"</code></li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="hls">HLS und CORS</h2>
    <p>In einigen Umgebungen (z. B. Amazon S3) können Sie eine CORS-Konfiguration für HLS angeben. Im Folgenden wird CORS so konfiguriert, dass die HLS-Wiedergabe möglich ist.</p>
    <pre class="line-numbers">
<code class="language-apache" translate="No">&lt;CORSConfiguration&gt;
      &lt;CORSRule&gt;
      &lt;AllowedOrigin&gt;*&lt;/AllowedOrigin&gt;
      &lt;AllowedMethod&gt;GET&lt;/AllowedMethod&gt;
      &lt;/CORSRule&gt;
&lt;/CORSConfiguration&gt;</code></pre>
    <p>Weitere Informationen zu Amazon S3 finden Sie unter <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html#how-do-i-enable-cors">Aktivieren der gemeinsamen Nutzung von Ressourcen zwischen verschiedenen Ursprüngen</a>.</p>
    <p>Obwohl der Client-Browser tangential zu CORS ist, muss er alle Sitzungscookies akzeptieren, damit die Bereitstellung von Token Authorized HLS-Inhalten ordnungsgemäß funktioniert. Während einige Client-Browser wie Google Chrome und Mozilla Firefox standardmäßig Sitzungscookies akzeptieren, tun andere Browser wie Internet Explorer dies nicht. Daher muss diese Option vom Benutzer aktiviert werden.</p>
  </section>
</article>